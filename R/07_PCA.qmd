---
title: "07_PCA"
format:
  html:
    self-contained: TRUE
---

## Load library

```{r}
#| message: false
library("tidyverse")
library("broom")
source("99_proj_func.R") # custom functions and theme
```

## Load data

```{r}
load("../data/04_data_for_modelling.Rdata")
```

```{r}
df <- df_num |> 
  select(where(is.numeric)) |>
  drop_na()
```

## Principal Component Analysis

### Numeric

```{r}
pca_fit <- df |>
  select(where(is.numeric)) |> 
  scale() |>
  prcomp() # do PCA on scaled data
```

### Variance explanation

```{r}
pca_fit |>
  tidy(matrix = "eigenvalues") |>
  ggplot(aes(PC, percent)) +
  geom_col(fill = "lightblue", 
           alpha = 0.8, 
           color = "black") +
  scale_y_continuous(
    labels = scales::percent_format(),
    expand = expansion(mult = c(0, 0.01))
  ) +
  best_theme() +
  labs(y = "Percent variance explained")
```

## Conclusion

After further testing it has been decided that the PCA will not reveal any additional information than already covered in previous analysis.

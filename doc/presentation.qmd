---
title: "Project presentation"
author: "Laurine Panel, Rasmus Tøffner-Clausen, Mathias Glerup Filtenborg, Alexander Videbæk, Qiju Chen"
date: "2 dec 2025"
format:
  revealjs:
    footer: "Project-group20"
    slide-number: true
    transition: "fade"
    smaller: true #to write smaller the text 
    #title-slide-attributes: 
      #data-background-image: background.png
    self-contained: true
---

## Introduction {background-image="../results/figures/background.png"}

::::: columns
::: column
### Dataset

-   The dataset focuses on patients with prostate cancer : one of the most common cancer types among men
-   Prostate dataset from this data base : https://hbiostat.org/data/

### Aim

-   Find out which treatment is the most effective
-   Determine which indicators are significant
-   Apply what we have learned
:::

::: column
![](dataset.png){width="80%"}
:::
:::::

## Materials and methods - Data preparation {background-image="../results/figures/background2.png"}

::::: columns
::: column
-   Downloaded into two separate sets:

#### Metadata

``` r
data_dir <- "../data/"
meta_tsv_file <- "01_meta_dat_load.tsv"
if (!file.exists(str_c(data_dir, meta_tsv_file)) ) {
  prostate |>
    select(patno, stage, status, age, wt, pf, hx, sdate) |>
    write_tsv(file = str_c(data_dir, meta_tsv_file))
```

#### Treatment data

``` r
treatment_tsv_file <- "01_treatment_dat_load.tsv"
if (!file.exists(str_c(data_dir, treatment_tsv_file)) ) {
  prostate |>
  select(-stage, -status, -age, -wt, -pf, -hx, -sdate) |>
    write_tsv(file = str_c(data_dir, treatment_tsv_file))
```
:::

::: column
-   Then converted the two raw files into a **tidy dataset**:
    -   by removing NA values
    -   creating survival event variables (0 and 1)
    -   removing ap outlines (exceeding 100 to avoid distortion)
:::
:::::

## Materials and methods {background-image="../results/figures/background2.png"}

-   For modelling we created two augmentations.

``` r
df_long <- df_num |>
  select(c(patient_no,stage, age, weight, follow_up_months,
                        sys_blood_pressure, dia_blood_pressure,
                        serum_hemoglobin, serum_prostatic_acid_phosphatase,
                        combined_index, size_of_primary_tumor, is_alive, performance, medical_history,ekg, bone_metastases, treatment, dosage)) |> 
  pivot_longer(cols = c(stage, age, weight, follow_up_months,
                        sys_blood_pressure, dia_blood_pressure,
                        serum_hemoglobin, serum_prostatic_acid_phosphatase,
                        combined_index, is_alive, performance, medical_history,ekg, bone_metastases, treatment, dosage),
               names_to = "variable",
               values_to = "value")
```

``` r
augment_data <- full_df |>
  mutate(MAP = (sys_blood_pressure+ 2 *dia_blood_pressure) / 3,
         is_alive = case_when(is_alive == "alive" ~ 0,
                              is_alive == "dead" ~ 1),
         treatment_detail = case_when(
           treatment == "placebo" ~ "Placebo",
           treatment == "estrogen" & dosage == 0.2 ~ "0.2mg Estrogen",
           treatment == "estrogen" & dosage == 1.0 ~ "1.0mg Estrogen",
           treatment == "estrogen" & dosage == 5.0 ~ "5.0mg Estrogen",
           TRUE ~ NA_character_),
         treatment_detail = factor(treatment_detail, 
                                   levels = c("Placebo", 
                                              "0.2mg Estrogen", 
                                              "1.0mg Estrogen", 
                                              "5.0mg Estrogen")),)
```

## Results - Preliminary model {background-image="../results/figures/background3.png"}

::::: columns
::: column
**Linear Volcano**\
![](../results/figures/linear_volcano.png){width="100%"}
:::

::: column
**Linear Tree**\
![](../results/figures/linear_forest_plot.png){width="100%"}
:::
:::::

## Results - Preliminary model {background-image="../results/figures/background3.png"}

::::: columns
::: column
**QQ-plot linear**\
![](../results/figures/linear_qq.png){width="100%"}
:::

::: column
**QQ-plot log**\
![](../results/figures/log_qq.png){width="100%"}
:::
:::::

## Results - Preliminary model {background-image="../results/figures/background3.png"}

::::: columns
::: column
**Log-Volcano**\
![](../results/figures/log_volcano.png){width="100%"}
:::

::: column
**Log-Forest**\
![](../results/figures/log_forest.png){width="100%"}
:::
:::::

## Results - Survival Analysis {background-image="../results/figures/background3.png"}

::::: columns
::: column
![](../results/figures/surv_curv%20by%20treatment.png){width="100%"}
:::

::: column
![](../results/figures/high_ap_comparison.png){width="100%"}
:::
:::::



## Results - Survival Analysis {background-image="../results/figures/background3.png"}

::::: layout-ncol
::: column
![](../results/figures/Univariate_cox_model.png){width="100%"}
:::

::: column
![](../results/figures/Multivarible_cox_model.png){width="100%"}
:::
:::::

## Discussion {background-image="../results/figures/background4.png"}

### How we can improve this project ?

#### Tons more data we'd like to model!

##### Building our own prediction model based on AP-levels.

#### Comparison with antigen data!
